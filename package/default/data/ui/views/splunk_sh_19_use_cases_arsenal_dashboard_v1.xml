<form theme="dark">
  <label>SH - 19 - Splunk Use Cases Arsenal - Dashboard - v1.5.15</label>
  <description>This Dashboard is powered by a KV Store that is populated from indexing all Splunk Essentials Apps on Sbase, all Correlation searches installed on the machine that are approved Splunk OOB or PS, it also contains the UBA use cases.  In other words, everything we have in our Arsenal.</description>
  <search id="Base_Search">
    <query>| inputlookup security_use_cases_lookup 
| fields Use_Case_Number Use_Case_Name Application_Context Description Adoption_Phase ATT_CK_Tactic Data_Enrichment Data_Model Data_Source Dataset ESCU_Analytic_Story ESCU_Asset_At_Risk ESCU_Channel ESCU_CIS_Critical_Security_Controls ESCU_Confidence ESCU_Creation_Date ESCU_Details ESCU_How_To_Implement ESCU_Known_False_Positives ESCU_Providing_Technologies ESCU_Required_Fields ESCU_Search_Type Kill_Chain_Phases Notable_Severity SE_Category SE_Data_Sources SE_Journey SE_Security_Use_Case Search Security_Domain source_data Use_Case_Collection
| eval Data_Model = case(Data_Model = "Change_Analysis", "Change", true(), Data_Model) 
| eval Adoption_Phase = if(isnull(Adoption_Phase), "Other", Adoption_Phase), Use_Case_Collection = if(isnull(Use_Case_Collection), "Other", Use_Case_Collection), ATT_CK_Tactic = if(isnull(ATT_CK_Tactic), "Other", ATT_CK_Tactic), Data_Model = if(isnull(Data_Model), "Other", Data_Model), Data_Source = if(isnull(Data_Source), "Other", Data_Source), Dataset = if(isnull(Dataset), "Other", Dataset), ESCU_Analytic_Story = if(isnull(ESCU_Analytic_Story), "Other", ESCU_Analytic_Story), Kill_Chain_Phases = if(isnull(Kill_Chain_Phases), "Other", Kill_Chain_Phases), ESCU_CIS_Critical_Security_Controls = if(isnull(ESCU_CIS_Critical_Security_Controls), "Other", ESCU_CIS_Critical_Security_Controls), SE_Category = if(isnull(SE_Category), "Other", SE_Category), SE_Data_Sources = if(isnull(SE_Data_Sources), "Other", SE_Data_Sources), SE_Journey = if(isnull(SE_Journey), "Other", SE_Journey), SE_Security_Use_Case = if(isnull(SE_Security_Use_Case), "Other", SE_Security_Use_Case), Search = if(isnull(Search), "Other", Search), Description = if(isnull(Description), "Other", Description)
    </query>
  </search>
  <search id="Post_Search" base="Base_Search">
    <query>search Application_Context = "$Application_Context$" AND Adoption_Phase = $Adoption_Phase$ AND Use_Case_Number = $Use_Case_Number$ AND Use_Case_Name = "*$Use_Case_Name$*" AND "Use_Case_Collection" = "$Use_Case_Collection$" AND "Data_Source" = "$Data_Source$" AND "Data_Model" = "$Data_Model$" AND "ESCU_Analytic_Story" = "$ESCU_Analytic_Story$" AND "Dataset" = "$Dataset$" AND "Kill_Chain_Phases" = "$Kill_Chain_Phases$" AND "SE_Category" = "$SE_Category$" AND "SE_Security_Use_Case" = "$SE_Security_Use_Case$" AND "SE_Journey" = "$SE_Journey$" AND "SE_Data_Sources" = "$SE_Data_Sources$" AND "ATT_CK_Tactic" = "$ATT_CK_Tactic$" AND "ESCU_CIS_Critical_Security_Controls" = "$ESCU_CIS_Critical_Security_Controls$" AND "Description" = "*$Description$*" AND "Search" = "*$Search$*"
    </query>
  </search>
  <fieldset submitButton="true" autoRun="true">
    <input type="text" token="Use_Case_Name" searchWhenChanged="true">
      <label>Use Case Name</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="text" token="Description" searchWhenChanged="true">
      <label>Description</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="text" token="Search" searchWhenChanged="true">
      <label>Search By Code</label>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Application_Context" searchWhenChanged="true">
      <label>Application Context</label>
      <fieldForLabel>Application_Context</fieldForLabel>
      <fieldForValue>Application_Context</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Application_Context | fields Application_Context</query>
      </search>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Data_Source" searchWhenChanged="true">
      <label>Data Source</label>
      <choice value="*">All</choice>
      <fieldForLabel>Data_Source</fieldForLabel>
      <fieldForValue>Data_Source</fieldForValue>
      <search base="Post_Search">
        <query>makemv delim="|" Data_Source | stats count by Data_Source | fields Data_Source</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Use_Case_Collection" searchWhenChanged="true">
      <label>Use Case Collection</label>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
      <fieldForLabel>Use_Case_Collection</fieldForLabel>
      <fieldForValue>Use_Case_Collection</fieldForValue>
      <search base="Post_Search">
        <query>stats count by "Use_Case_Collection" | fields "Use_Case_Collection"
        </query>
      </search>
    </input>
    <input type="dropdown" token="Adoption_Phase" searchWhenChanged="true">
      <label>Adoption Phase</label>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
      <fieldForLabel>Adoption_Phase</fieldForLabel>
      <fieldForValue>Adoption_Phase</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Adoption_Phase | fields Adoption_Phase</query>
      </search>
    </input>
    <input type="dropdown" token="Use_Case_Number" searchWhenChanged="true">
      <label>Use Case Number</label>
      <choice value="*">All</choice>
      <default>*</default>
      <initialValue>*</initialValue>
      <fieldForLabel>Use_Case_Number</fieldForLabel>
      <fieldForValue>Use_Case_Number</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Use_Case_Number | fields Use_Case_Number</query>
      </search>
    </input>
    <input type="dropdown" token="SE_Journey" searchWhenChanged="true">
      <label>SE Journey</label>
      <choice value="*">All</choice>
      <fieldForLabel>SE_Journey</fieldForLabel>
      <fieldForValue>SE_Journey</fieldForValue>
      <search base="Post_Search">
        <query>stats count by SE_Journey | fields SE_Journey</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="SE_Security_Use_Case" searchWhenChanged="true">
      <label>SE Security Use Case</label>
      <choice value="*">All</choice>
      <fieldForLabel>SE_Security_Use_Case</fieldForLabel>
      <fieldForValue>SE_Security_Use_Case</fieldForValue>
      <search base="Post_Search">
        <query>stats count by SE_Security_Use_Case | fields SE_Security_Use_Case</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="SE_Category" searchWhenChanged="true">
      <label>SE Category</label>
      <choice value="*">All</choice>
      <fieldForLabel>SE_Category</fieldForLabel>
      <fieldForValue>SE_Category</fieldForValue>
      <search base="Post_Search">
        <query>stats count by SE_Category | fields SE_Category</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="SE_Data_Sources" searchWhenChanged="true">
      <label>SE Data Sources</label>
      <choice value="*">All</choice>
      <fieldForLabel>SE_Data_Sources</fieldForLabel>
      <fieldForValue>SE_Data_Sources</fieldForValue>
      <search base="Post_Search">
        <query>stats count by SE_Data_Sources | fields SE_Data_Sources</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Kill_Chain_Phases" searchWhenChanged="true">
      <label>Kill Chain Phases</label>
      <choice value="*">All</choice>
      <fieldForLabel>Kill_Chain_Phases</fieldForLabel>
      <fieldForValue>Kill_Chain_Phases</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Kill_Chain_Phases 
| eval Kill_Chain_Phases = if(Kill_Chain_Phases = "Actions on Objective", "Actions on Objectives", Kill_Chain_Phases)
| dedup Kill_Chain_Phases 
| fields Kill_Chain_Phases</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="ATT_CK_Tactic" searchWhenChanged="true">
      <label>MITRE ATT&amp;CK Tactic</label>
      <choice value="*">All</choice>
      <fieldForLabel>ATT_CK_Tactic</fieldForLabel>
      <fieldForValue>ATT_CK_Tactic</fieldForValue>
      <search base="Post_Search">
        <query>stats count by ATT_CK_Tactic | fields ATT_CK_Tactic</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="ESCU_Analytic_Story" searchWhenChanged="true">
      <label>ESCU_Analytic_Story</label>
      <choice value="*">All</choice>
      <fieldForLabel>ESCU_Analytic_Story</fieldForLabel>
      <fieldForValue>ESCU_Analytic_Story</fieldForValue>
      <search base="Post_Search">
        <query>stats count by ESCU_Analytic_Story | fields ESCU_Analytic_Story</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Data_Model" searchWhenChanged="true">
      <label>Data Models</label>
      <choice value="*">All</choice>
      <fieldForLabel>Data_Model</fieldForLabel>
      <fieldForValue>Data_Model</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Data_Model | fields Data_Model</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="Dataset" searchWhenChanged="true">
      <label>Dataset</label>
      <choice value="*">All</choice>
      <fieldForLabel>Dataset</fieldForLabel>
      <fieldForValue>Dataset</fieldForValue>
      <search base="Post_Search">
        <query>stats count by Dataset | fields Dataset</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="dropdown" token="ESCU_CIS_Critical_Security_Controls" searchWhenChanged="true">
      <label>CIS Critical Security Controls</label>
      <choice value="*">All</choice>
      <fieldForLabel>ESCU_CIS_Critical_Security_Controls</fieldForLabel>
      <fieldForValue>ESCU_CIS_Critical_Security_Controls</fieldForValue>
      <search base="Post_Search">
        <query>stats count by ESCU_CIS_Critical_Security_Controls 
| fields ESCU_CIS_Critical_Security_Controls
| sort +ESCU_CIS_Critical_Security_Controls</query>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>$env:page$</title>
      <single>
        <title>Total Number of Use Cases</title>
        <search base="Post_Search">
          <query>stats count</query>
        </search>
        <option name="colorMode">block</option>
        <option name="drilldown">all</option>
        <option name="rangeColors">["0x555","0xdc4e41","0xf1813f","0xf8be34","0x006d9c","0x53a051"]</option>
        <option name="rangeValues">[0,100,200,400,500]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
      </single>
      <table>
        <search base="Post_Search">
          <query>| stats count by Adoption_Phase</query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="Adoption_Phase">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="count">
          <colorPalette type="minMidMax" maxColor="#006D9C" midColor="#62B3B2" minColor="#FFFFFF"></colorPalette>
          <scale type="minMidMax" midValue="40"></scale>
        </format>
      </table>
    </panel>
    <panel>
      <chart>
        <title>Data Sources</title>
        <search base="Post_Search">
          <query>stats count by Data_Source</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
      <chart>
        <title>MITRE ATT&amp;CK Tactic</title>
        <search base="Post_Search">
          <query>stats count by ATT_CK_Tactic | where ATT_CK_Tactic != ""</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>List of Use Cases</title>
      <table>
        <search base="Post_Search">
          <query>table Use_Case_Name Use_Case_Number Application_Context Adoption_Phase Data_Source Description Search
| sort Use_Case_Name</query>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Adoption_Phase">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Data_Source">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Application_Context">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Use_Case_Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Splunk and The SANS Top 20 Critical Security Controls</title>
      <table>
        <title>https://www.splunk.com/en_us/form/top-20-csc-report.html     /      https://www.sans.org/media/critical-security-controls/critical-controls-poster-2016.pdf    /     https://www.sans.org/security-resources/posters/security-leadership-cis-controls/55/download</title>
        <search>
          <query>| inputlookup cis_controls_app_data_lookup
| search category = "$ESCU_CIS_Critical_Security_Controls$:*"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">7</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="family">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="category">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Use_Case_Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>ES Content Library</title>
      <table>
        <search>
          <query>| rest /services/configs/conf-analytic_stories splunk_server=local count=0 
| spath input=data_models path={} output=Data_Models 
| spath input=mappings path=kill_chain_phases{} output=Kill_Chain_Phases 
| spath input=mappings path=cis20{} output=cis 
| spath input=mappings path=mitre_attack{} output=ATT&amp;CK 
| spath input=providing_technologies path={} output=Providing_Technologies 
| rex field=cis "CIS\s(?&lt;num&gt;\d+)" 
| rename num as CIS 
| rename title as ESCU_Analytic_Story description as Description category as Category creation_date as Created modification_date as Last_Updated 
| rex field=ESCU_Providing_Technologies mode=sed "s/\"|\[|\]//g" 
| rex field=ESCU_Data_Models mode=sed "s/\"|\[|\]//g" 
| rex field=detection_searches mode=sed "s/\"|\[|\]//g" 
| rex field=investigative_searches mode=sed "s/\"|\[|\]//g" 
| rex field=reference mode=sed "s/\"|\[|\]//g" 
| rex field=support_searches mode=sed "s/\"|\[|\]//g" 
| rex field=ESCU_Required_Fields mode=sed "s/\"|\[|\]//g" 
| rex field=Rule_Name mode=sed "s/^ESCU - //g" 
| rex field=mappings mode=sed "s/\"|\[|\]|{|}//g" 
| rex field=Category mode=sed "s/\"//g" 
| makemv delim=", " detection_searches 
| makemv delim=", " investigative_searches 
| makemv delim=", " reference 
| makemv delim=", " support_searches 
| makemv delim=", " mappings 
| fields Category detection_searches investigative_searches mappings providing_technologies reference support_searches ATT&amp;CK Created CIS Data_Models ESCU_Analytic_Story Description Kill_Chain_Phases Last_Updated Providing_Technologies narrative version 
| stats values(Category) as Category values(Kill_Chain_Phases) as Kill_Chain_Phases values(ATT&amp;CK) as ATT&amp;CK values(CIS) as CIS values(detection_searches) as detection_searches values(investigative_searches) as investigative_searches values(support_searches) as support_searches values(Providing_Technologies) as Providing_Technologies values(reference) as reference dc(detection_searches) as num_detection_searches count by ESCU_Analytic_Story 
| table ESCU_Analytic_Story num_detection_searches detection_searches Category Kill_Chain_Phases ATT&amp;CK Data_Models CIS investigative_searches support_searches Providing_Technologies reference 
| mvexpand detection_searches 
| search "ESCU_Analytic_Story" = "$ESCU_Analytic_Story$" AND "ATT&amp;CK" = "$ATT_CK_Tactic$" AND "Kill_Chain_Phases" = "$Kill_Chain_Phases$" AND "Category" = "$SE_Category$"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">4</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Category">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Kill_Chain_Phases">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="ATT&amp;CK">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="reference">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="ESCU_Analytic_Story">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Category">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Kill_Chain_Phases">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="ATT&amp;CK">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="reference">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="ESCU_Analytic_Story">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="detection_searches">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Splunk PS Data Source Naming Convention</title>
      <table>
        <search>
          <query>| inputlookup use_case_data_source_desc_lookup
| table Data_Source_Name Data_Source_Type Data_Source_Description
| search Data_Source_Name = "$Data_Source$"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">true</option>
        <format type="color" field="Data_Source_Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Data_Source_Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>MITRE ATT&amp;CK  Matrix</title>
      <table>
        <title>Globally-accessible knowledge base of adversary tactics and techniques based on real-world observations of cyberattacks.</title>
        <search>
          <query>| mitremap 
| transpose 100 column_name="Tactic" 
| rename "row *" AS technique_* 
| untable Tactic Technique_Order Technique 
| eval Technique_Order=substr(Technique_Order,11,2) 
| sort Technique_Order 
| streamstats count AS Tactic_Order 
| eval Tactic_Order=if(Technique_Order="1",Tactic_Order,null) 
| sort Tactic Tactic_Order 
| filldown Tactic_Order 
| sort Tactic_Order Technique_Order 
| table Tactic Tactic_Order Technique Technique_Order 
| stats list(Technique) AS Technique list(Technique_Order) AS Technique_Order count as Num_Of_Techniques BY Tactic Tactic_Order 
| sort + Tactic_Order
| search Tactic = "$ATT_CK_Tactic$"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">1</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">preview</option>
        <option name="rowNumbers">true</option>
        <format type="color" field="Tactic">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Tactic_Order">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
</form>